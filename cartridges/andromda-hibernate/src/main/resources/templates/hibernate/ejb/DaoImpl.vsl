#if ($umlUtils.shouldOutput($entity))
#set ($generatedFile = "${entity.packagePath}/${entity.daoImplementationName}.java")
// license-header java merge-point
#if ($entity.daoImplementationRequired)
/**
 * This is only generated once! It will never be overwritten.
 * Generated by DaoImpl.vsl in andromda-ejb3-cartridge on $umlUtils.date.
 * You can (and have to!) safely modify it by hand.
 */
#else
/**
 * Attention: Generated code! Do not modify by hand!
 * Generated by DaoImpl.vsl in andromda-ejb3-cartridge on $umlUtils.date.
 */
#end
#if ($stringUtils.isNotBlank($entity.packageName))
package ${entity.packageName};
#end

#set ($superclass = $entity.generalization)
/**
 * @see $entity.fullyQualifiedEntityName
 */
public class $entity.daoImplementationName
    extends $entity.fullyQualifiedDaoBaseName
{
#if ($entity.daoBusinessOperations && $entity.valueObjectReferences.empty)
    // This entity has no Business Operations and no ValueObject dependency references
#end
#foreach ($operation in $entity.daoBusinessOperations)
#**##set ($returnType = $operation.returnType)
#**##set ($returnObject = "returnValue")
#**##set ($signature = "$operation.implementationSignature")
    /**
     * @see ${entity.fullyQualifiedDaoName}${esc.hash}${operation.getSignature(false)}
     */
#if ($javaVersion.compareTo("1.6")>-1)
    @Override
#end
    protected $operation.getterSetterReturnTypeName $signature
#**##if ($operation.exceptionsPresent)
        throws $operation.exceptionList
#**##end
    {
        // TODO implement $operation.visibility $returnType.fullyQualifiedName $signature
#**##if ($operation.returnTypePresent)
        return $operation.returnType.javaNullString;
#**##else
        throw new UnsupportedOperationException("${entity.fullyQualifiedEntityName}.${signature} Not implemented!");
#**##end
    }

#end
#foreach ($valueObjectRef in $entity.allValueObjectReferences)
    /**
     * @see ${entity.fullyQualifiedDaoName}${esc.hash}${valueObjectRef.transformationMethodName}($entity.fullyQualifiedEntityName, $valueObjectRef.targetElement.fullyQualifiedName)
     */
#if ($javaVersion.compareTo("1.6")>-1)
    @Override
#end
    public void ${valueObjectRef.transformationMethodName}(
        $entity.fullyQualifiedEntityName sourceEntity,
        $valueObjectRef.targetElement.fullyQualifiedName targetVO)
    {
        // ${toDoTag} verify behavior of ${valueObjectRef.transformationMethodName}
        super.${valueObjectRef.transformationMethodName}(sourceEntity, targetVO);
#**##foreach ($property in $valueObjectRef.targetElement.allProperties)
#*  *##foreach ($entityProp in $entity.allProperties)
#*    *##if ($property.name == $entityProp.name)
#*      *##set ($getVal = false)
#*      *##set ($getVal = $converter.typeConvert($entityProp.type.fullyQualifiedName, "sourceEntity.${entityProp.getterName}()", $property.type.fullyQualifiedName) )
#*      *##if (!$getVal)
        // WARNING! No conversion for targetVO.${property.name} (can't convert sourceEntity.${entityProp.getterName}():${entityProp.type.fullyQualifiedName} to $property.type.fullyQualifiedName
#*      *##end
#*    *##end
#*  *##end
#**##end
    }

    /**
     * @see ${entity.fullyQualifiedDaoName}${esc.hash}${valueObjectRef.transformationMethodName}($entity.fullyQualifiedEntityName)
     */
#if ($javaVersion.compareTo("1.6")>-1)
    @Override
#end
    public $valueObjectRef.targetElement.fullyQualifiedName ${valueObjectRef.transformationMethodName}(final $entity.fullyQualifiedEntityName entity)
    {
        // ${toDoTag} verify behavior of ${valueObjectRef.transformationMethodName}
        return super.${valueObjectRef.transformationMethodName}(entity);
    }

    /**
     * Retrieves the entity object that is associated with the specified value object
     * from the object store. If no such entity object exists in the object store,
     * a new, blank entity is created
     */
    private $entity.fullyQualifiedEntityName load${entity.name}From${valueObjectRef.targetElement.name}($valueObjectRef.targetElement.fullyQualifiedName $stringUtils.uncapitalize($valueObjectRef.name))
    {
        // ${toDoTag} implement load${entity.name}From${valueObjectRef.targetElement.name}
        throw new UnsupportedOperationException("${entity.packageName}.load${entity.name}From${valueObjectRef.targetElement.name}($valueObjectRef.targetElement.fullyQualifiedName) not yet implemented.");

        /* A typical implementation looks like this:
        $entity.fullyQualifiedEntityName $stringUtils.uncapitalize($entity.name) = this.load(${stringUtils.uncapitalize($valueObjectRef.name)}.getId());
        if ($stringUtils.uncapitalize($entity.name) == null)
        {
            $stringUtils.uncapitalize($entity.name) = ${entity.fullyQualifiedEntityName}.Factory.newInstance();
        }
        return $stringUtils.uncapitalize($entity.name);
        */
    }

    /**
     * @see ${entity.fullyQualifiedDaoName}${esc.hash}${valueObjectRef.transformationToEntityMethodName}($valueObjectRef.targetElement.fullyQualifiedName)
     */
#if ($javaVersion.compareTo("1.6")>-1)
    @Override
#end
    public $entity.fullyQualifiedEntityName ${valueObjectRef.transformationToEntityMethodName}($valueObjectRef.targetElement.fullyQualifiedName $stringUtils.uncapitalize($valueObjectRef.name))
    {
        // ${toDoTag} verify behavior of ${valueObjectRef.transformationToEntityMethodName}
        $entity.fullyQualifiedEntityName entity = this.load${entity.name}From${valueObjectRef.targetElement.name}($stringUtils.uncapitalize($valueObjectRef.name));
        this.${valueObjectRef.transformationToEntityMethodName}($stringUtils.uncapitalize($valueObjectRef.name), entity, true);
        return entity;
    }

    /**
     * @see ${entity.fullyQualifiedDaoName}${esc.hash}${valueObjectRef.transformationToEntityMethodName}($valueObjectRef.targetElement.fullyQualifiedName, $entity.fullyQualifiedEntityName, boolean)
     */
#if ($javaVersion.compareTo("1.6")>-1)
    @Override
#end
    public void ${valueObjectRef.transformationToEntityMethodName}(
        $valueObjectRef.targetElement.fullyQualifiedName sourceVO,
        $entity.fullyQualifiedEntityName targetEntity,
        boolean copyIfNull)
    {
        // ${toDoTag} verify behavior of ${valueObjectRef.transformationToEntityMethodName}
        super.${valueObjectRef.transformationToEntityMethodName}(sourceVO, targetEntity, copyIfNull);
#**##set ($attributes = $entity.getAttributes(true,false))
#**##foreach ($attribute in $attributes)
#*  *##foreach ($voProperty in $valueObjectRef.targetElement.allProperties)
#*    *##if ($attribute.name == $voProperty.name)
#*      *##set ($getVal = false)
#*      *##set ($getVal = $converter.typeConvert($voProperty.type.fullyQualifiedName, "sourceVO.${voProperty.getterName}()", ${attribute.getterSetterTypeName}) )
#*      *##if (!$getVal)
        // No conversion for targetEntity.${attribute.name} (can't convert sourceVO.${voProperty.getterName}():${voProperty.type.fullyQualifiedName} to ${attribute.getterSetterTypeName}
#*      *##end
#*    *##end
#*  *##end
#**##end
    }

#end
}
#end
