<cartridge>

    <templateEngine className="org.andromda.templateengines.velocity.VelocityTemplateEngine">
        <macrolibrary name="templates/ejb3/GlobalMacros.vm"/>
        <macrolibrary name="templates/ejb3/common/JNDIMacros.vm"/>
        <!-- cartridge-macrolibrary merge-point-->
    </templateEngine>

    <!-- define the template objects that are made available to the template -->
    <templateObject name="stringUtils" className="org.apache.commons.lang3.StringUtils"/>
    <templateObject name="collectionUtils" className="org.apache.commons.collections.CollectionUtils"/>
    <templateObject name="umlUtils" className="org.andromda.metafacades.uml.UMLMetafacadeUtils"/>
    <templateObject name="entityUtils" className="org.andromda.metafacades.uml.EntityMetafacadeUtils"/>
    <templateObject name="transform" className="org.andromda.cartridges.ejb3.EJB3ScriptHelper"/>
    <templateObject name="converter" className="org.andromda.utils.JavaTypeConverter">
        <property reference="javaTypeConversionIgnoreList"/>
    </templateObject>
    <!-- cartridge-templateObject merge-point-->

    <templatePostProcessor className="org.andromda.core.common.ImportBeautifierPostProcessorImpl"/>

    <property reference="toDoTag"/>
    <property reference="driver"/>
    <property reference="username"/>
    <property reference="password"/>
    <property reference="connectionUrl"/>
    <property reference="dataSource"/>
    <property reference="dataSourceName"/>
    <property reference="testDialect"/>
    <property reference="testDriver"/>
    <property reference="testConnectionUrl"/>
    <property reference="testUsername"/>
    <property reference="testPassword"/>
    <property reference="testCatalog"/>
    <property reference="entityManagerName"/>
    <property reference="hibernateHbm2DDLAuto"/>
    <property reference="hibernateDialect"/>
    <property reference="hibernateShowSql"/>
    <property reference="hibernateMaxFetchDepth"/>
    <property reference="hibernateJdbcFetchSize"/>
    <property reference="hibernateJdbcBatchSize"/>
    <property reference="hibernateJdbcUseScrollableResultSet"/>
    <property reference="hibernateJdbcUseStreamsForBinary"/>
    <property reference="hibernateCacheProvider"/>
    <property reference="hibernateTreecacheMbeanObject"/>
    <property reference="hibernateEnableCache"/>
    <property reference="hibernateEnableAssociationsCache"/>
    <property reference="hibernateUseQueryCache"/>
    <property reference="useDefaultCacheRegion"/>
    <property reference="hibernateTransactionManagerLookupClass"/>
    <property reference="hibernateTransactionFlushBeforeCompletion"/>
    <property reference="hibernateTransactionAutoCloseSession"/>
    <property reference="serviceLocatorName"/>
    <property reference="manageableServiceLocatorName"/>
    <property reference="ejb3TypesPackage"/>
    <property reference="persistenceProviderExtensions"/>
    <property reference="persistenceContextUnitName"/>
    <property reference="javaVersion"/>
    <property reference="deploymentPlatform"/>
    <property reference="persistenceContainerName"/>
    <property reference="parameterRequiredCheck"/>
    <property reference="xmlEncoding"/>
    <property reference="enableTemplating"/>
    <property reference="jndiNamePrefix"/>
    <property reference="securityRealm"/>
    <property reference="manageableRolesAllowed"/>
    <property reference="enableClustering"/>
    <property reference="webServiceContextRoot"/>
    <property reference="webServiceUrlPattern"/>
    <property reference="dao-impls"/>
    <property reference="daos"/>
    <property reference="daoType"/>
    <property reference="daoInheritanceEnabled"/>
    <property reference="daoNamedQueries"/>
    <property reference="enableDaoPropertiesCreateMethod"/>
    <property reference="seamEnabled"/>
    <property reference="jarFiles"/>
    <property reference="test-impls"/>
    <property reference="tests"/>
    <property reference="hibernateNamespace"/>
    <property reference="entityHibernateValidations"/>
    <property reference="entityVOTransformations"/>
    <property reference="entityCmpEqHash"/>
    <property reference="entityFindersOnUniqueProperties"/>

    <!-- cartridge-property merge-point -->

    <condition name="enableTemplating">$enableTemplating.equalsIgnoreCase("true")</condition>
    <condition name="daoInheritanceEnabled">$daoInheritanceEnabled.equalsIgnoreCase("true")</condition>
    <condition name="daoNamedQueries">$daoNamedQueries.equalsIgnoreCase("true")</condition>
    <condition name="entityHibernateValidations">$entityHibernateValidations.equalsIgnoreCase("true")</condition>
    <condition name="entityVOTransformations">$entityVOTransformations.equalsIgnoreCase("true")</condition>
    <condition name="entityCmpEqHash">$entityCmpEqHash.equalsIgnoreCase("true")</condition>
    <condition name="entityFindersOnUniqueProperties">$entityFindersOnUniqueProperties.equalsIgnoreCase("true")</condition>

    <!-- condition merge-point-->

    <!-- cartridge-resource merge-point -->

    <resource
        path="lib/jboss/microcontainer/*.rar"
        outputPattern="{0}"
        outlet="test-config"
        overwrite="true"
        lastModifiedCheck="true"/>

    <!-- cartridge-templateObject merge-point-->

    <!-- Entity Bean Templates -->

    <!-- Test class which constructs Entity with minimal required properties, all properties, and updates minimal to all props.
    Used instead of Mock object so that a persistable Entity is created for testing purposes, for both Entity and EJB/Dao tests -->
    <template
        path="templates/ejb3/test/EntityCreate.vsl"
        outputPattern="$generatedFile"
        outlet="test-impls"
        overwrite="true">
        <modelElements variable="entity">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <!--template
        path="templates/ejb3/test/AllEntities.java.vsl"
        outputPattern="$generatedFile"
        outlet="test-impls"
        outputToSingleFile="true"
        outputOnEmptyElements="false"
        overwrite="false">
        <modelElements>
            <modelElement variable="entities">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
        </modelElements>
    </template-->

    <template
        path="templates/ejb3/test/JPAJUnitAncestor.java.vsl"
        outputPattern="org/andromda/dbtest/JPAJUnitAncestor.java"
        outlet="test-impls"
        outputToSingleFile="true"
        outputOnEmptyElements="false"
        overwrite="false">
        <modelElements>
            <modelElement variable="entity">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/test/H2.java.vsl"
        outputPattern="org/andromda/dbtest/H2.java"
        outlet="test-impls"
        outputToSingleFile="true"
        outputOnEmptyElements="false"
        overwrite="false">
        <modelElements>
            <modelElement variable="entity">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/test/Priority.java.vsl"
        outputPattern="org/andromda/dbtest/Priority.java"
        outlet="test-impls"
        outputToSingleFile="true"
        outputOnEmptyElements="false"
        overwrite="false">
    </template>

    <template
        path="templates/ejb3/test/PriorityInterceptor.java.vsl"
        outputPattern="org/andromda/dbtest/PriorityInterceptor.java"
        outlet="test-impls"
        outputToSingleFile="true"
        outputOnEmptyElements="false"
        overwrite="false">
    </template>

    <template
        path="templates/ejb3/config/persistence.xml.vsl"
        outputPattern="META-INF/persistence.xml"
        outlet="entity-config"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="entities">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
            <modelElement variable="persistenceContexts">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3PersistenceContextFacade"/>
            </modelElement>
        </modelElements>
    </template>
    <!-- Run all entities before individual entities, so entity sort/priority is cached for all -->
    <template
        path="templates/ejb3/config/beans.xml.vsl"
        outputPattern="META-INF/beans.xml"
        outlet="entity-config"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
    </template>

    <!-- Run all entities before individual entities, so entity sort/priority is cached for all -->
    <template
        path="templates/ejb3/test/persistence.xml.vsl"
        outputPattern="META-INF/persistence.xml"
        outlet="test-config"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="entities">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
        </modelElements>
    </template>
    <!-- Hibernate reverse engineering configuration using name mappings from the model -->
    <template
        path="templates/ejb3/config/reveng.xml.vsl"
        outputPattern="reveng.xml"
        outlet="test-config"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="entities">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
        </modelElements>
    </template>
    <template
        path="templates/ejb3/DAOFactory.java.vsl"
        outputPattern="$generatedFile"
        outlet="entity-beans"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="entities">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/test/log4j.xml.vsl"
        outputPattern="log4j.xml"
        outlet="test-config"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="entities">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
        </modelElements>
    </template>
    <template
        path="templates/ejb3/test/persistence.xml.vsl"
        outputPattern="META-INF/persistence.xml.ref"
        outlet="test-refs"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="entities">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/test/EntityTest.java.vsl"
        outputPattern="$generatedFile"
        outlet="test-impls"
        outputToSingleFile="false"
        outputOnEmptyElements="false"
        overwrite="false">
        <modelElements>
            <modelElement variable="entity">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <!--template
        path="templates/ejb3/test/CreateTest.java.vsl"
        outputPattern="$generatedFile"
        outlet="test-impls"
        outputToSingleFile="false"
        outputOnEmptyElements="false"
        overwrite="false">
        <modelElements>
            <modelElement variable="entity">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/test/DeleteTest.java.vsl"
        outputPattern="$generatedFile"
        outlet="test-impls"
        outputToSingleFile="false"
        outputOnEmptyElements="false"
        overwrite="false">
        <modelElements>
            <modelElement variable="entity">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
        </modelElements>
    </template-->

    <template
        path="templates/ejb3/EntityEmbeddable.vsl"
        outputPattern="$generatedFile"
        outlet="entity-beans"
        overwrite="true">
        <modelElements variable="entity">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <!--
        Do not generate the entity implementation class if marked
        to be an embeddable super class OR is a subclass of an
        entity inheritance hierarchy.
    -->
    <template
        path="templates/ejb3/Entity.vsl"
        outputPattern="$generatedFile"
        outlet="entity-impls"
        overwrite="false">
        <modelElements variable="entity">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade">
                    <property name="entityImplementationRequired"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/Entity.vsl"
        outputPattern="$generatedFile"
        outlet="java-refs"
        overwrite="true">
        <modelElements variable="entity">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade">
                    <property name="entityImplementationRequired"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/EntityListener.vsl"
        outputPattern="$generatedFile"
        outlet="entity-impls"
        overwrite="false">
        <modelElements variable="entity">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade">
                    <property name="listenerEnabled"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/EntityListener.vsl"
        outputPattern="$generatedFile"
        outlet="java-refs"
        overwrite="true">
        <modelElements variable="entity">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade">
                    <property name="listenerEnabled"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/EntityCompositePK.vsl"
        outputPattern="$generatedFile"
        outlet="entity-beans"
        overwrite="true">
        <modelElements variable="entity">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade">
                    <property name="compositePrimaryKeyPresent"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <!-- Session Bean Templates -->

    <template
        path="templates/ejb3/SessionBeanBase.vsl"
        outputPattern="$generatedFile"
        outlet="session-beans"
        overwrite="true">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/SessionInterface.vsl"
        outputPattern="$generatedFile"
        outlet="session-beans"
        overwrite="true"
        generateEmptyFiles="true">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/SessionLocal.vsl"
        outputPattern="$generatedFile"
        outlet="session-beans"
        overwrite="true"
        generateEmptyFiles="true">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade">
                    <property name="viewTypeLocal"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/SessionRemote.vsl"
        outputPattern="$generatedFile"
        outlet="session-beans"
        overwrite="true"
        generateEmptyFiles="true">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade">
                    <property name="viewTypeRemote"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/SessionBeanImpl.vsl"
        outputPattern="$generatedFile"
        outlet="session-impls"
        overwrite="false">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/SessionBeanImpl.vsl"
        outputPattern="$generatedFile"
        outlet="java-refs"
        overwrite="true">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/SessionListener.vsl"
        outputPattern="$generatedFile"
        outlet="session-impls"
        overwrite="false">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade">
                    <property name="listenerEnabled"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/SessionListener.vsl"
        outputPattern="$generatedFile"
        outlet="java-refs"
        overwrite="true">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade">
                    <property name="listenerEnabled"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/ServiceDelegate.vsl"
        outputPattern="$generatedFile"
        outlet="services"
        overwrite="true">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/ServiceDelegateBase.vsl"
        outputPattern="$generatedFile"
        outlet="services"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/ServiceLocator.vsl"
        outputPattern="$generatedFile"
        outlet="services"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/WebServiceInterface.vsl"
        outputPattern="$generatedFile"
        outlet="services"
        overwrite="true">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3WebServiceFacade">
                    <property name="webServiceEnabled"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/DefaultServiceException.vsl"
        outputPattern="$generatedFile"
        outlet="commons"
        overwrite="true">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade">
                    <property name="allowDefaultServiceException"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <!-- DAO Templates -->

    <template
        path="templates/ejb3/DaoLocal.vsl"
        outputPattern="$generatedFile"
        outlet="daos"
        overwrite="true">
        <modelElements variable="entity">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade">
                    <property name="embeddableSuperclass">false</property>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/DaoBase.vsl"
        outputPattern="$generatedFile"
        outlet="daos"
        overwrite="true">
        <modelElements variable="entity">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade">
                    <property name="embeddableSuperclass">false</property>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/DaoImpl.vsl"
        outputPattern="$generatedFile"
        outlet="daos"
        overwrite="true">
        <modelElements variable="entity">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade">
                    <property name="daoImplementationRequired">false</property>
                    <property name="embeddableSuperclass">false</property>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/DaoImpl.vsl"
        outputPattern="$generatedFile"
        outlet="dao-impls"
        overwrite="false">
        <modelElements variable="entity">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade">
                    <property name="daoImplementationRequired"/>
                    <property name="embeddableSuperclass">false</property>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/DaoImpl.vsl"
        outputPattern="$generatedFile"
        outlet="java-refs"
        overwrite="true">
        <modelElements variable="entity">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade">
                    <property name="daoImplementationRequired"/>
                    <property name="embeddableSuperclass">false</property>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/DaoDefaultException.vsl"
        outputPattern="$generatedFile"
        outlet="commons"
        overwrite="true">
        <modelElements variable="entity">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade">
                    <property name="embeddableSuperclass">false</property>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <!-- Configuration Templates -->

    <template
        path="templates/ejb3/config/orm.xml.vsl"
        outputPattern="META-INF/orm.xml"
        outlet="session-config"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="embeddables">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EmbeddedValueFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/config/ejb-jar.xml.vsl"
        outputPattern="META-INF/ejb-jar.xml"
        outlet="session-config"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
            <modelElement variable="mdbs">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade"/>
            </modelElement>
            <modelElement variable="interceptors">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3InterceptorFacade"/>
            </modelElement>
            <modelElement variable="manageables">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3ManageableEntityFacade"/>
            </modelElement>
            <modelElement variable="entities">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/config/jboss/jboss.xml.vsl"
        outputPattern="META-INF/jboss.xml"
        outlet="session-config"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
            <modelElement variable="mdbs">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade"/>
            </modelElement>
            <modelElement variable="manageables">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3ManageableEntityFacade"/>
            </modelElement>
            <modelElement variable="entities">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/config/jboss/components.xml.vsl"
        outputPattern="META-INF/components.xml"
        outlet="session-config"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
            <modelElement variable="entities">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
            <modelElement variable="valueobjects">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3ValueObjectFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/config/jboss/login-config.xml.vsl"
        outputPattern="$generatedFile"
        outlet="application-metainf"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade">
                    <property name="securityEnabled"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/config/jboss/login-service.xml.vsl"
        outputPattern="$generatedFile"
        outlet="application-metainf"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade">
                    <property name="securityEnabled"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/config/jboss/jboss-app.xml.vsl"
        outputPattern="jboss-app.xml"
        outlet="application-metainf"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade">
                    <property name="securityEnabled"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/config/jboss/auth.conf.vsl"
        outputPattern="auth.conf"
        outlet="application-config"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade">
                    <property name="securityEnabled"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/config/jboss/ejb3-entity-cache-service.xml.vsl"
        outputPattern="ejb3-entity-cache-service.xml"
        outlet="application-config"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="entities">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade">
                    <property name="cacheEnabled"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/config/jboss/mq-destinations-service.xml.vsl"
        outputPattern="$generatedFile"
        outlet="application-config"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="mdbs">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <!-- Message Driven Bean Templates -->

    <template
        path="templates/ejb3/MessageDrivenBean.vsl"
        outputPattern="$generatedFile"
        outlet="message-driven-beans"
        overwrite="true">
        <modelElements variable="mdb">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/MessageDrivenBeanImpl.vsl"
        outputPattern="$generatedFile"
        outlet="message-driven-impls"
        overwrite="false">
        <modelElements variable="mdb">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/MessageDrivenBeanImpl.vsl"
        outputPattern="$generatedFile"
        outlet="java-refs"
        overwrite="true">
        <modelElements variable="mdb">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/MessageDrivenListener.vsl"
        outputPattern="$generatedFile"
        outlet="message-driven-impls"
        overwrite="false">
        <modelElements variable="mdb">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade">
                    <property name="listenerEnabled"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/MessageDrivenListener.vsl"
        outputPattern="$generatedFile"
        outlet="java-refs"
        overwrite="true">
        <modelElements variable="mdb">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade">
                    <property name="listenerEnabled"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <!-- Common Templates -->

    <template
        path="templates/ejb3/Interceptor.vsl"
        outputPattern="$generatedFile"
        outlet="session-impls"
        overwrite="false">
        <modelElements variable="interceptor">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3InterceptorFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/Interceptor.vsl"
        outputPattern="$generatedFile"
        outlet="java-refs"
        overwrite="true">
        <modelElements variable="interceptor">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3InterceptorFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <!-- Deprecated: Use Java TypeSafeEnumeration instead -->
    <template
        path="templates/ejb3/Enumeration.vsl"
        outputPattern="$generatedFile"
        outlet="user-types"
        overwrite="true">
        <modelElements variable="enumeration">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EnumerationFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/EmbeddedValue.vsl"
        outputPattern="$generatedFile"
        outlet="entity-beans"
        overwrite="true">
        <modelElements variable="embeddedValue">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EmbeddedValueFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/EmbeddedValueImpl.vsl"
        outputPattern="$generatedFile"
        outlet="entity-impls"
        overwrite="false">
        <modelElements variable="embeddedValue">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EmbeddedValueFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/EmbeddedValueImpl.vsl"
        outputPattern="$generatedFile"
        outlet="java-refs"
        overwrite="true">
        <modelElements variable="embeddedValue">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EmbeddedValueFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <!-- CRUD Manageable Templates -->

    <template
        path="templates/ejb3/crud/ManageableServiceLocator.vsl"
        outputPattern="$generatedFile"
        outlet="services"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements variable="manageables">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3ManageableEntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/crud/ManageableServiceRemote.vsl"
        outputPattern="$generatedFile"
        outlet="session-beans"
        overwrite="true">
        <modelElements variable="manageable">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3ManageableEntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/crud/ManageableServiceBase.vsl"
        outputPattern="$generatedFile"
        outlet="session-beans"
        overwrite="true">
        <modelElements variable="manageable">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3ManageableEntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/crud/ManageableServiceCreateException.vsl"
        outputPattern="$generatedFile"
        outlet="commons"
        overwrite="true">
        <modelElements variable="manageable">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3ManageableEntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/crud/ManageableServiceReadException.vsl"
        outputPattern="$generatedFile"
        outlet="commons"
        overwrite="true">
        <modelElements variable="manageable">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3ManageableEntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/crud/ManageableServiceUpdateException.vsl"
        outputPattern="$generatedFile"
        outlet="commons"
        overwrite="true">
        <modelElements variable="manageable">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3ManageableEntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/crud/ManageableServiceDeleteException.vsl"
        outputPattern="$generatedFile"
        outlet="commons"
        overwrite="true">
        <modelElements variable="manageable">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3ManageableEntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <!-- TestNG test framework tests -->

    <template
        path="templates/ejb3/test/testng.xml.vsl"
        outputPattern="testng.xml"
        outlet="test-config"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="true">
        <modelElements>
            <modelElement variable="entities">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
            <modelElement variable="mdbs">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/test/testjms.xml.vsl"
        outputPattern="testjms.xml"
        outlet="test-config"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="mdbs">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/test/EJB3Container.vsl"
        outputPattern="$generatedFile"
        outlet="test-impls"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
            <modelElement variable="mdbs">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/test/EJB3Container.vsl"
        outputPattern="$generatedFile"
        outlet="test-refs"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
            <modelElement variable="mdbs">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/test/SessionTest.vsl"
        outputPattern="$generatedFile"
        outlet="test-impls"
        overwrite="false">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/test/SessionTest.vsl"
        outputPattern="$generatedFile"
        outlet="test-refs"
        overwrite="true">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/test/MessageDrivenTest.vsl"
        outputPattern="$generatedFile"
        outlet="test-impls"
        overwrite="false">
        <modelElements variable="mdb">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/test/MessageDrivenTest.vsl"
        outputPattern="$generatedFile"
        outlet="test-refs"
        overwrite="true">
        <modelElements variable="mdb">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <!-- Microcontainer templates -->

    <template
        path="templates/ejb3/microcontainer/default.persistence.properties.vsl"
        outputPattern="default.persistence.properties"
        outlet="test-config"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/microcontainer/ejb3-interceptors-aop.xml.vsl"
        outputPattern="ejb3-interceptors-aop.xml"
        outlet="test-config"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/microcontainer/embedded-jboss-beans.xml.vsl"
        outputPattern="embedded-jboss-beans.xml"
        outlet="test-config"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/microcontainer/jboss-jms-beans.xml.vsl"
        outputPattern="jboss-jms-beans.xml"
        outlet="test-config"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/microcontainer/jndi.properties.vsl"
        outputPattern="jndi.properties"
        outlet="test-config"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/microcontainer/log4j.xml.vsl"
        outputPattern="log4j.xml"
        outlet="test-config"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>
    <template
        path="templates/ejb3/microcontainer/log4j.xml.vsl"
        outputPattern="log4j.xml"
        outlet="test-refs"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/microcontainer/login-config.xml.vsl"
        outputPattern="login-config.xml"
        outlet="test-config"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/microcontainer/security-beans.xml.vsl"
        outputPattern="security-beans.xml"
        outlet="test-config"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/microcontainer/roles.properties.vsl"
        outputPattern="roles.properties"
        outlet="test-config"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/ejb3/microcontainer/users.properties.vsl"
        outputPattern="users.properties"
        outlet="test-config"
        overwrite="false"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <!-- cartridge-template merge-point -->

</cartridge>