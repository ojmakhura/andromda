<project name="AndroMDACartridges" default="dist">

    <!-- ============================================================= -->
    <!--               Directory settings                              -->
    <!-- ============================================================= -->

    <!-- destination directories -->
    <property name="dist.dir"         value="dist"   />

    <!-- Setup directory structure -->
    <target name="init">
        <tstamp/>
        <mkdir dir="${dist.dir}"/>
    </target>

    <!-- Remove directory structure -->
    <target name="clean" description="Removes all generated files">
        <delete includeEmptyDirs="true" quiet="true">
            <fileset dir="${dist.dir}"/>
        </delete>
        
        <antcall target="cleanCartridge">
          <param name="cartridge.name" value="andromda-java"/>
        </antcall>
        <antcall target="cleanCartridge">
          <param name="cartridge.name" value="andromda-ejb"/>
        </antcall>
        <antcall target="cleanCartridge">
          <param name="cartridge.name" value="andromda-hibernate"/>
        </antcall>
        <antcall target="cleanCartridge">
          <param name="cartridge.name" value="andromda-struts"/>
        </antcall>
        
    </target>

    <!-- ============================================================= -->
    <!--               Highlevel user tasks                            -->
    <!-- ============================================================= -->

    <target name="buildCartridge">
        <echo message="buildCartridge ${cartridge.name}"/>
        <ant inheritAll="false" dir="./${cartridge.name}" />
        <copy taskname="${cartridge.name}" todir="${dist.dir}/${cartridge.name}">
          <fileset dir="./${cartridge.name}/dist">
            <include name="**/*"/>
          </fileset>
        </copy>
    </target>

    <target name="cleanCartridge">
        <echo message="cleanCartridge ${cartridge.name}"/>
        <ant inheritAll="false" dir="./${cartridge.name}" target="clean"/>
    </target>

    <target name="dist" depends="clean,init"
            description="Builds core, cartridges, samples and website">

        <antcall target="buildCartridge">
          <param name="cartridge.name" value="andromda-java"/>
        </antcall>
        <antcall target="buildCartridge">
          <param name="cartridge.name" value="andromda-ejb"/>
        </antcall>
        <antcall target="buildCartridge">
          <param name="cartridge.name" value="andromda-hibernate"/>
        </antcall>
        <antcall target="buildCartridge">
          <param name="cartridge.name" value="andromda-struts"/>
        </antcall>

    </target>

</project>
