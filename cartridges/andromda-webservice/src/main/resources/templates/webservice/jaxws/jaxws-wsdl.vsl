#if ($umlUtils.shouldOutput($service))
<?xml version="1.0" encoding="$xmlEncoding"?>
<!-- Generated by andromda-webservice cartridge (jaxws/jaxws-wsdl.vsl) on $webServiceUtils.date -->
#parse("templates/webservice/Globals.vm")
#set ($namespace="$webServiceUtils.reversePackage($service.packageName)#if($addNamespaceBackslash)/#end")
##    <!-- $defaultParameterStyle ${service.packageName} $extensionInheritanceDisabled -->
<wsdl:definitions
    name="${service.qName}"
    targetNamespace="http://$namespace"
    xmlns:${service.namespacePrefix}="http://$namespace"
#if ($defaultParameterStyle.equalsIgnoreCase("BARE"))
## Abbreviations for all namespcaes referenced by wsdl operations
#set ($schemaTypes = $service.typeMappingElements)
#set ($pkgRefs = $webServiceUtils.getPackageReferences($service, $schemaTypes, $service.packageName, $extensionInheritanceDisabled))
#else
#set ($pkgRefs = $webServiceUtils.getPackageReferences($service, null, $service.packageName, $extensionInheritanceDisabled))
#end
#set ($exceptionRefs = $webServiceUtils.getExceptionReferences($service.package))
##    xmlns:$webServiceUtils.getPkgAbbr($service.package)="http://$webServiceUtils.reversePackage($service.packageName)#if($addNamespaceBackslash)/#end"
#foreach ($pkgRef in $exceptionRefs)
    xmlns:$webServiceUtils.getPkgAbbr($pkgRef)="http://$webServiceUtils.reversePackage($pkgRef.fullyQualifiedName)#if($addNamespaceBackslash)/#end"
#end
    xmlns:xs="$xmlSchemaNamespace"
    xmlns:soap="$wsdlSoapNamespace"
##    xmlns:xsd="$xmlSchemaNamespace"
#if ($service.hasStereotype("WSCustomHeader"))
#set ($serviceHeaderAbbr = $service.findTaggedValue("andromda_header_abbr"))
#set ($serviceHeaderNamespace = $service.findTaggedValue("andromda_header_namespace"))
    xmlns:$serviceHeaderAbbr="$serviceHeaderNamespace"
#end
#if ($service.hasStereotype("WSSecurity"))
#set ($serviceSecurityAbbr = $service.findTaggedValue("andromda_security_abbr"))
#if ($stringUtils.isEmpty($serviceSecurityAbbr))#set ($serviceSecurityAbbr="wsse")#end
#set ($serviceSecurityNamespace = $service.findTaggedValue("andromda_security_namespace"))
#if ($stringUtils.isEmpty($serviceSecurityNamespace))#set ($serviceSecurityNamespace="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd")#end
    xmlns:$serviceSecurityAbbr="$serviceSecurityNamespace"
    xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd"
#end
    xmlns:wsdl="$wsdlNamespace">
##    xmlns:http="http://schemas.xmlsoap.org/wsdl/http#if($addNamespaceBackslash)/#end"
##    xmlns:xformat="http://cxf.apache.org/bindings/xformat">
##    <!-- pkgRefs=$pkgRefs.size() schemaTypes=$schemaTypes.size() -->
##if ($defaultParameterStyle.equalsIgnoreCase("BARE"))
##    <wsdl:import namespace="http://$webServiceUtils.reversePackage($service.packageName)#if($addNamespaceBackslash)/#end" xmlns="http://www.w3.org/2001/XMLSchema" location="http://$webServiceUtils.reversePackage($service.packageName)"/>
##foreach ($pkgRef in $pkgRefs)
##    <wsdl:import namespace="http://$webServiceUtils.reversePackage($pkgRef.fullyQualifiedName)#if($addNamespaceBackslash)/#end" xmlns="http://www.w3.org/2001/XMLSchema" location="http://$webServiceUtils.reversePackage($pkgRef.fullyQualifiedName)#if($addNamespaceBackslash)/#end"/>
##end
##end
#if ($service.hasStereotype("WSCustomHeader"))
#set ($serviceHeaderXSDlocation = $service.findTaggedValue("andromda_header_XSDlocation"))
#if ($stringUtils.isEmpty($serviceHeaderXSDlocation))#set ($serviceHeaderXSDlocation=$serviceHeaderNamespace)#end
    <wsdl:import namespace="$serviceHeaderNamespace" location="$serviceHeaderXSDlocation"/>
#end
#if ($service.hasStereotype("WSSecurity"))
#set ($serviceSecurityXSDlocation = $service.findTaggedValue("andromda_security_XSDlocation"))
#if ($stringUtils.isEmpty($serviceSecurityXSDlocation))#set ($serviceSecurityXSDlocation=$serviceSecurityNamespace)#end
    <wsdl:import namespace="$serviceSecurityNamespace" location="$serviceSecurityXSDlocation"/>
#end
    <!-- WSDL Types, with separate interface element schema definitions from wsdl endpoint definition -->
##    <!-- CXF 2.0.x throws an exception when referencing imported relative schemas: must include entire schema definition here -->
    <wsdl:types>
#if($importedXSD)
        <xs:schema>
            <xs:import namespace="http://$webServiceUtils.reversePackage($service.packageName)#if($addNamespaceBackslash)/#end"
                schemaLocation="xsd/${webServiceUtils.reversePackage($service.packageName)}.xsd"/>
#foreach ($pkgRef in $exceptionRefs)
            <xs:import namespace="http://$webServiceUtils.reversePackage($pkgRef.fullyQualifiedName)#if($addNamespaceBackslash)/#end"
                schemaLocation="xsd/${webServiceUtils.reversePackage($pkgRef.fullyQualifiedName)}.xsd"/>
#end
        </xs:schema>
#else
#parse("templates/webservice/jaxws/jaxws-included-xsd.vsl")
#end
    </wsdl:types>

    <!-- Messages - Correspond to service $defaultParameterStyle method parameters -->
## I'm not sure why ns: works instead of impl: for element references, but the wsdl gives an eror if it's not used
#foreach ($operation in $service.allowedOperations)
#if ($operation.visibility.equals("public") && !$operation.rest)
## Bare not possible if any parameters have minOccurs > 1 or default values
#set ($isMany=false)
#foreach ($parameter in $operation.parameters)
#if (!$useArrayWrapper && ($parameter.upper>1 || $parameter.upper==-1))
#set ($isMany=true)
#end
#end
#if ($defaultParameterStyle.equalsIgnoreCase("WRAPPED") || $isMany)
#if ($operation.returnTypePresent || $operation.exceptionsPresent)
    <wsdl:message name="${operation.operationName}Response">
        <wsdl:part name="${operation.operationName}Response" element="${service.namespacePrefix}:${operation.operationName}Response"/>
    </wsdl:message>
#end
    <wsdl:message name="${operation.operationName}">
## element name must not have RequestWrapper, otherwise Java is generated as BARE instead of WRAPPED
        <wsdl:part name="${operation.operationName}" element="${service.namespacePrefix}:${operation.operationName}"/>
    </wsdl:message>
#else
## No Request/Response wrappers in message or types
    <wsdl:message name="${operation.operationName}">
#foreach ($parameter in $operation.arguments)
#if ($stringUtils.isBlank($parameter.type.packageName) || $parameter.type.packageName.equals("PrimitiveTypes") || $stringUtils.substring($parameter.type.schemaType, 0, 3).equals("xs:"))
#set ($type=$parameter.type.schemaType)
##        <!-- blank $parameter.type.name type.packageName=$parameter.type.packageName schemaType=$parameter.type.schemaType $parameter.type $parameter.type.fullyQualifiednName-->
#else
#set ($type="${service.namespacePrefix}:$parameter.type.name")
##        <!-- nb $parameter.type.name type.packageName=$parameter.type.packageName schemaType=$parameter.type.schemaType $parameter.type $parameter.type.fullyQualifiednName-->
#end
# Determine if attribute/element is a simple schema type when it starts with xs:
#if ($stringUtils.isNotBlank($parameter.getDocumentation("", 9999, false)))
        <wsdl:part name="$parameter.name" element="$type">
            <wsdl:documentation>
$stringUtils.replaceChars($parameter.getDocumentation("            ", 100, false), "\"'&<>", "")
            </wsdl:documentation>
        </wsdl:part>
#else
        <wsdl:part name="$parameter.name" element="$type"/>
#end
#end
    </wsdl:message>
#if ($operation.returnTypePresent || $operation.exceptionsPresent)
    <wsdl:message name="${operation.operationName}Response">
#if ($stringUtils.isBlank($operation.returnType.packageName) || $parameter.type.packageName.equals("PrimitiveTypes") || $stringUtils.substring($operation.returnType.schemaType, 0, 3).equals("xs:"))
#set ($type=$operation.returnType.schemaType)
##        <!-- blank $operation.returnType.name packageName=$operation.returnType.packageName schemaType=$operation.returnType.schemaType $operation.returnType $operation.returnType.fullyQualifiednName-->
#else
#set ($type="${service.namespacePrefix}:$operation.returnType.name")
##        <!-- nb $operation.returnType.name packageName=$operation.returnType.packageName schemaType=$operation.returnType.schemaType $operation.returnType $operation.returnType.fullyQualifiednName-->
#end
        <wsdl:part element="$type" name="${operation.operationName}Response"/>
    </wsdl:message>
#end
#end
#end
#end
##set($outerCount = $velocityCount)
## Assume the first Exception association is the XML WebFault ValueObject
#foreach($exception in $service.allowedOperationExceptions)
#if ($exception.associationEnds.empty)
#set ($faultName=$exception.name.replace("Exception", "Fault"))
#set ($faultPkg=$webServiceUtils.getPkgAbbr($exception.package))
#else
#set ($faultName=$exception.associationEnds.get(0).otherEnd.type.name)
#set ($faultPkg=$webServiceUtils.getPkgAbbr($exception.associationEnds.get(0).otherEnd.type.package))
#end
    <wsdl:message name="$faultName">
        <wsdl:part element="$faultPkg:$faultName" name="$faultName"/>
    </wsdl:message>
#end
#if ($service.hasStereotype("WSCustomHeader"))
#set ($serviceHeaderPartName = $service.findTaggedValue("andromda_wsdl_header_partName"))
#set ($serviceHeaderElementName = $service.findTaggedValue("andromda_wsdl_header_element"))
    <wsdl:message name="$serviceHeaderPartName">
        <wsdl:part name="$serviceHeaderPartName" element="$serviceHeaderAbbr:$serviceHeaderElementName"/>
    </wsdl:message>
#end
#if ($service.hasStereotype("WSSecurity"))
#set ($serviceSecurityPartName = $service.findTaggedValue("andromda_wsdl_security_partName"))
#if ($stringUtils.isEmpty($serviceSecurityPartName))#set ($serviceSecurityPartName="wsse")#end
#set ($serviceSecurityElementName = $service.findTaggedValue("andromda_wsdl_security_element"))
#if ($stringUtils.isEmpty($serviceSecurityElementName))#set ($serviceSecurityElementName="Security")#end
    <wsdl:message name="$serviceSecurityPartName">
        <wsdl:part name="$serviceSecurityPartName" element="$serviceSecurityAbbr:$serviceSecurityElementName"/>
    </wsdl:message>
#end

    <!-- Port Type: Service Endpoint Interface implemented by SEI Endpoint which delegates to WSDelegate -->
    <wsdl:portType name="${service.qName}">
#foreach ($operation in $service.allowedOperations)
#if ($operation.visibility.equals("public") && !$operation.rest)
        <wsdl:operation name="$operation.operationName">
#if ($stringUtils.isNotBlank($operation.getDocumentation("", 9999, false)))
            <wsdl:documentation>
$stringUtils.replaceChars($operation.getDocumentation("                ", 100, false), "\"'&<>", "")
            </wsdl:documentation>
#end
            <wsdl:input name="${operation.operationName}" message="${service.namespacePrefix}:${operation.operationName}"/>
#if ($operation.returnTypePresent || $operation.exceptionsPresent)
            <wsdl:output name="${operation.operationName}Response" message="${service.namespacePrefix}:${operation.operationName}Response"/>
#end
##set($outerCount = $velocityCount)
#foreach($exception in $operation.exceptions)
#if ($exception.associationEnds.empty)
#set ($faultName=$exception.name.replace("Exception", "Fault"))
#else
#set ($faultName=$exception.associationEnds.get(0).otherEnd.type.name)
#end
##            <wsdl:fault name="${exception.name}" message="$webServiceUtils.getPkgAbbr($exception.package):${exception.name}"/>
            <wsdl:fault name="$faultName" message="${service.namespacePrefix}:$faultName"/>
#end
        </wsdl:operation>
#end
#end
    </wsdl:portType>

#set ($serviceBindingName = "${service.qName}SoapBinding")
    <!-- WSDL Binding - Corresponds to service transport -->
    <wsdl:binding name="$serviceBindingName" type="${service.namespacePrefix}:${service.qName}">
        <soap:binding style="document"
            transport="$documentStyleTransportNamespace" />
#foreach ($operation in $service.allowedOperations)
#if ($operation.visibility.equals("public") && !$operation.rest)
        <wsdl:operation name="$operation.operationName">
            <soap:operation soapAction="$operation.operationName" style="document" />
##if ($defaultParameterStyle.equalsIgnoreCase("WRAPPED"))
##            <wsdl:input name="${operation.operationName}RequestWrapper">
##else
            <wsdl:input name="${operation.operationName}">
##end
                <soap:body use="literal"/>
#if ($service.hasStereotype("WSCustomHeader"))
                <soap:header message="impl:$serviceHeaderPartName" part="$serviceHeaderPartName" use="literal"/>
#end
#if ($service.hasStereotype("WSSecurity"))
                <soap:header message="impl:$serviceSecurityPartName" part="$serviceSecurityPartName" use="literal"/>
#end
            </wsdl:input>
#if ($operation.returnTypePresent || $operation.exceptionsPresent)
            <wsdl:output name="${operation.operationName}Response">
                <soap:body use="literal"/>
            </wsdl:output>
##else
##            <wsdl:output>
#end
##set($outerCount = $velocityCount)
#foreach($exception in $operation.exceptions)
#if ($exception.associationEnds.empty)
#set ($faultName=$exception.name.replace("Exception", "Fault"))
#else
#set ($faultName=$exception.associationEnds.get(0).otherEnd.type.name)
#end
            <wsdl:fault name="$faultName">
                <soap:fault name="$faultName" use="literal"/>
            </wsdl:fault>
#end
        </wsdl:operation>
#end
#end
    </wsdl:binding>

    <!-- Service Definition: Service Endpoint Client Implementation -->
    <wsdl:service name="${service.qName}">
#if ($stringUtils.isNotBlank($service.getDocumentation("", 9999, false)))
        <wsdl:documentation>
$stringUtils.replaceChars($service.getDocumentation("            ", 100, false), "\"'&<>", "")
        </wsdl:documentation>
#end
        <wsdl:port name="${service.qName}" binding="${service.namespacePrefix}:${serviceBindingName}">
            <soap:address location="http://${webserviceHost}:${webservicePort}/$webContext/$servicesPath/$service.qName" />
        </wsdl:port>
    </wsdl:service>

</wsdl:definitions>
#end