/**
 * ng-popup - Angular modeless dialog without jQuery dependency
 * @author Marko Cen
 * @version v0.4.1
 * @link http://markocen.github.io/ngPopup/ngPopupDemo.html
 * @license MIT
 */
var ngPopup=angular.module("ngPopup",[]);ngPopup.factory("ngPopupBuilder",["$q","$http","$document","$log","$compile",function(e,t,i,n,o){var s=!1,a=0,l=0,p={layoutInitAsync:function(i){var o=i.template?i.template:"",s=e.defer(),a='<div class="container"><div class="resizeCorner"><div class="left-top-corner"></div><div class="left-bottom-corner"></div><div class="right-top-corner"></div><div class="right-bottom-corner"></div></div><div class="resizeBar"><div class="top-bar"></div><div class="right-bar"></div><div class="bottom-bar"></div><div class="left-bar"></div></div><div class="titleBar" ng-show="option.hasTitleBar"><span class="title">{{option.title}}</span><div class="iconGroup"><i class="fa fa-minus" ng-click="action.minimize(option.isMinimized)" id="minBtn"></i><i class="fa fa-expand" ng-click="action.maximize(option.isMaximized)" id="maxBtn"></i><i class="fa fa-map-pin" ng-click="action.togglePin($event)" id="pinBtn"></i><i class="fa fa-close" ng-click="action.close($event)" id="closeBtn"></i></div></div><div class="content" ng-class="{contentNoBar:!option.hasTitleBar}">';return i.templateUrl?t.get(i.templateUrl).then(function(e){a+=o+e.data+"</div></div>",s.resolve(a)},function(e){n.error(e),s.reject(e)}):(a+=o+"</div></div>",s.resolve(a)),s.promise},getDefaultMethods:function(e,t){var i=t[0],n={open:function(t){null!=t&&(i.style.top=t.top+"px",i.style.left=t.left+"px",e.position.top=t.top,e.position.left=t.left),e.onOpen&&e.onOpen(),e.isShow=!0},close:function(t){e.onClose&&e.onClose(),e.isShow=!1,s=!0},maximize:function(t){t?(i.style.height=a+"px",i.style.width=l+"px",e.width=i.offsetWidth,e.height=i.offsetHeight,angular.element(document.querySelector("#maxBtn")).removeClass("fa-compress").addClass("fa-expand")):(a=i.offsetHeight,l=i.offsetWidth,i.getElementsByClassName("content")[0].style.display="block",i.style.top="5px",i.style.left="5px",i.style.width="calc( 100vw - 10px )",i.style.height="calc( 100vh - 10px )",e.position.top=i.offsetTop,e.position.left=i.offsetLeft,e.width=i.offsetWidth,e.height=i.offsetHeight,angular.element(document.querySelector("#maxBtn")).removeClass("fa-expand").addClass("fa-compress")),e.isMaximized=!e.isMaximized,s=!0},minimize:function(t){t?(i.style.height=e.height+"px",i.style.width=e.width+"px",i.style.top=e.position.top+"px",i.style.left=e.position.left+"px",i.getElementsByClassName("content")[0].style.display="block",angular.element(document.querySelector("#minBtn")).removeClass("fa-plus").addClass("fa-minus"),e.position.top=i.offsetTop,e.position.left=i.offsetLeft):(i.getElementsByClassName("content")[0].style.display="none",i.style.height=i.getElementsByClassName("titleBar")[0].style.height,i.style.width="200px",angular.element(document.querySelector("#minBtn")).removeClass("fa-minus").addClass("fa-plus")),e.isMinimized=!e.isMinimized,s=!0},togglePin:function(){1!=e.pinned?(document.querySelector("#pinBtn").style.color="#EB5342",e.pinned=!0):(document.querySelector("#pinBtn").style.color="",e.pinned=!1),s=!0},isMaximized:function(){return e.isMaximized},isMinimized:function(){return e.isMinimized}};return n},getDefaultOptions:function(e){return e?(e.modelName=e.modelName||"ngPopup",e.width=e.width||100,e.height=e.height||100,e.template=e.template||"",e.templateUrl=e.templateUrl||null,e.resizable=null==e.resizable?!0:e.resizable,e.draggable=null==e.draggable?!0:e.draggable,e.position=e.position||{top:0,left:0},e.title=e.title||"Welcome to ngPopup!",e.hasTitleBar=null==e.hasTitleBar?!0:e.hasTitleBar,e.pinned=null==e.pinned?!1:e.pinned,e.isShow=null==e.isShow?!0:e.isShow,e.isMinimized=null==e.isMinimized?!1:e.isMinimized,e.isMaximized=null==e.isMaximized?!1:e.isMaximized,e.onOpen=e.onOpen||function(){},e.onClose=e.onClose||function(){},e.onDragStart=e.onDragStart||function(){},e.onDragEnd=e.onDragEnd||function(){},e.onResize=e.onResize||function(){},e):{modelName:"myDialog",width:100,height:100,template:"",templateUrl:null,resizable:!0,draggable:!0,position:{top:-1,left:-1},title:"Welcome to ngPopup!",hasTitleBar:!0,pinned:!1,isShow:!0,onOpen:function(){},onClose:function(){},onDragStart:function(){},onDragEnd:function(){},onResize:function(){}}},updateParentScopeOptions:function(e,t){var i=t[0];e.position.top=i.offsetTop,e.position.left=i.offsetLeft,"none"!=i.getElementsByClassName("content")[0].style.display&&(e.width=i.offsetWidth,e.height=i.offsetHeight)},updateElementSize:function(e,t,i){var n=e[0];"string"==typeof t&&("%"==t.slice(-1)?n.style.width=t:n.style.width=parseInt(t,10)+"px"),"number"==typeof t&&(n.style.width=t+"px"),"string"==typeof i&&("%"==i.slice(-1)?n.style.height=i:n.style.height=parseInt(i,10)+"px"),"number"==typeof i&&(n.style.height=i+"px")},updateElementPosition:function(e,t){var i=e[0];"string"==typeof t.top&&(i.style.top=t.top),"number"==typeof t.top&&(i.style.top=t.top+"px"),"string"==typeof t.left&&(i.style.left=t.left),"number"==typeof t.left&&(i.style.left=t.left+"px")},updateBindingValue:function(e,t,i){var n=i.scope,o=i.element,a=(i.attrs,o[0]);e.pinned?a.style.position="fixed":a.style.position="absolute",n.option.isMinimized||p.updateElementSize(o,e.width,e.height),(e.position.top!=t.position.top||e.position.left!=e.position.left)&&(a.style.top=e.position.top+"px",a.style.left=e.position.left+"px"),e.isShow==t.isShow||s||(e.isShow?e.onOpen&&e.onOpen():e.onClose&&e.onClose()),(e.width!=t.width||e.height!=t.height)&&e.onResize&&e.onResize(),e.hasTitleBar!=t.hasTitleBar&&(n.option.hasTitleBar=e.hasTitleBar),s=!1}};return p}]),ngPopup.directive("ngPopUp",["$parse","$document","$timeout","$templateCache","$compile","ngPopupBuilder",function(e,t,i,n,o,s){return{restrict:"EA",scope:{option:"=?"},replace:!0,template:'<div class="ngPopup" ng-show="option.isShow"></div>',link:function(e,n,a){var l=n[0],p=s.getDefaultOptions(e.option),d=(p.modelName,!1),r=!1,u=!1,c={scope:e,element:n,attrs:a};s.layoutInitAsync(p).then(function(t){var i=o(t)(e);n.append(i),s.updateBindingValue(p,s.getDefaultOptions(),c),u=!0}),e.$watch("option",function(e,t){u&&s.updateBindingValue(e,t,c)},!0),e.action=s.getDefaultMethods(p,n),n.bind("mousedown",function(o){i(function(){var a=angular.element(o.target),u=parseFloat(window.getComputedStyle(l,null).top),c=parseFloat(window.getComputedStyle(l,null).left),f=parseFloat(window.getComputedStyle(l,null).height),m=parseFloat(window.getComputedStyle(l,null).width),h=o.pageY,g=o.pageX;if(a.hasClass("titleBar")||a.hasClass("title")||a.parent().hasClass("contentNoBar")||a.hasClass("contentNoBar")){if(0==p.draggable)return;p.onDragStart&&(p.onDragStart(),d=!0),t.find("body").addClass("unselectable"),t.bind("mousemove",function(t){i(function(){l.style.top=t.pageY-h+u+"px",l.style.left=t.pageX-g+c+"px",s.updateParentScopeOptions(e.option,n)})})}if(a.parent().hasClass("resizeCorner")){if(0==p.resizable)return void t.find("body").removeClass("unselectable");p.onResize&&(p.onResize(),r=!0),t.find("body").addClass("unselectable"),a.hasClass("right-bottom-corner")?t.bind("mousemove",function(t){i(function(){l.style.height=f+t.pageY-h+"px",l.style.width=m+t.pageX-g+"px",s.updateParentScopeOptions(e.option,n)})}):a.hasClass("right-top-corner")?t.bind("mousemove",function(t){i(function(){l.style.top=t.pageY+"px",l.style.width=m+t.pageX-g+"px",l.style.height=f-t.pageY+h+"px",s.updateParentScopeOptions(e.option,n)})}):a.hasClass("left-top-corner")?t.bind("mousemove",function(t){i(function(){l.style.left=c+t.pageX-g+"px",l.style.top=t.pageY+"px",l.style.width=m-t.pageX+g+"px",l.style.height=f-t.pageY+h+"px",s.updateParentScopeOptions(e.option,n)})}):a.hasClass("left-bottom-corner")&&t.bind("mousemove",function(t){i(function(){l.style.left=t.pageX+"px",l.style.width=m-t.pageX+g+"px",l.style.height=f+t.pageY-h+"px",s.updateParentScopeOptions(e.option,n)})})}if(a.parent().hasClass("resizeBar")){if(0==p.resizable)return void t.find("body").removeClass("unselectable");p.onResize&&(p.onResize(),r=!0),t.find("body").addClass("unselectable"),a.hasClass("left-bar")?t.bind("mousemove",function(t){i(function(){l.style.left=c+t.pageX-g+"px",l.style.width=m-t.pageX+g+"px",s.updateParentScopeOptions(e.option,n)})}):a.hasClass("right-bar")?t.bind("mousemove",function(t){i(function(){l.style.width=m+t.pageX-g+"px",s.updateParentScopeOptions(e.option,n)})}):a.hasClass("top-bar")?t.bind("mousemove",function(t){i(function(){l.style.top=t.pageY+"px",l.style.height=f-t.pageY+h+"px",s.updateParentScopeOptions(e.option,n)})}):a.hasClass("bottom-bar")&&t.bind("mousemove",function(t){i(function(){l.style.height=f+t.pageY-h+"px",s.updateParentScopeOptions(e.option,n)})})}})}),n.bind("mouseup",function(e){i(function(){p.onDragEnd&&d&&(p.onDragEnd(),d=!1,r=!1),t.find("body").removeClass("unselectable"),t.unbind("mousemove")})})}}}]);