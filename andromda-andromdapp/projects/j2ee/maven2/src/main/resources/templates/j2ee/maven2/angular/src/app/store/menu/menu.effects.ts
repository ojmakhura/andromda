// Generated by andromda-angular cartridge (app\usecase\effect.store.ts.vsl) DO NOT EDIT
import { Injectable } from '@angular/core';
import { Actions, createEffect, ofType } from '@ngrx/effects';
import { catchError, map, mergeMap } from 'rxjs/operators';
import * as MenuActions from './menu.actions';
import { KeycloakService } from 'keycloak-angular';
import { UrlGuardRestControllerImpl } from '@app/service/bw/org/bocra/portal/guard/url-guard-rest-controller.impl';
import { UrlGuardCriteria } from '@app/model/bw/org/bocra/portal/guard/url-guard-criteria';
import { UrlGuardType } from '@app/model/bw/org/bocra/portal/guard/url-guard-type';
import * as nav from '@app/shell/navigation';

@Injectable()
export class MenuEffects {
  constructor(private actions$: Actions, private keycloakService: KeycloakService, private urlGuardRestController: UrlGuardRestControllerImpl) {}

//   getMenus$ = createEffect(() =>
//   this.actions$.pipe(
//     ofType(MenuActions.getMenus),
//     mergeMap(() => {
//       let criteria: UrlGuardCriteria = new UrlGuardCriteria();
//       criteria.type = UrlGuardType.MENU;
//       criteria.roles = this.keycloakService.getUserRoles();

//       this.urlGuardRestController.search(criteria).pipe(
//         map(({ guards }) => {
//           nav.menuItems.forEach((value) => {
//             guards.find((guard) => {
//               if (guard.url === value.routerLink) {
//                 MenuActions.addMenu({menu: value})
//               }
//             });
//           });
//         }),
//         catchError(({ error }) => [MenuActions.authFailure(error)])
//       )
//     })
//   )
// );

}
