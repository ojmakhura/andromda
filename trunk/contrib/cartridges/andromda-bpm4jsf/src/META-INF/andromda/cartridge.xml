<cartridge>
    
    <!-- define the template objects that are made available to the template -->
    <templateObject name="stringUtils" className="org.andromda.core.common.StringUtilsHelper"/>
    <templateObject name="bpmUtils" className="org.andromda.cartridges.bpm4jsf.BPM4JSFUtils"/>
    <!-- cartridge-templateObject merge-point-->

    <property reference="xmlEncoding"/>
    <property reference="facesConfig"/>
    <property reference="jspIncludes"/>
    <property reference="messageResources"/>
    <property reference="welcomeFileName"/>
    <property reference="facesServletExtension"/>
    <property reference="managedBeansPackage"/>
    <property reference="layoutOptionsName"/>
    <property reference="layoutOptionsBeanName"/>
    <property reference="sidebarLayout"/>
    <property reference="menuLayout"/>
    <property reference="navigationTheme"/>
    <property reference="applicationName"/>
    <property reference="exceptionHandlerPattern"/>
    <property reference="actionFormKey"/>
    <property reference="patternMatchingExceptionHandler"/>
    <property reference="defaultDateFormat"/>
    <property reference="defaultTimeFormat"/>
    <property reference="dummyData"/>
    <!-- cartridge-property merge-point -->

    <!-- cartridge-resource merge-point -->
    <resource
        path="resources/views/jsp/css/*.*"
        outputPattern="css/{0}"
        outlet="jsps"
        overwrite="true"/>
    
    <resource
        path="resources/views/images/*.*"
        outputPattern="images/{0}"
        outlet="jsps"
        overwrite="true"/>

    <!-- process templates on model elements -->
    <template
        path="templates/bpm4jsf/configuration/web.xml.vsl"
        outputPattern="web.xml"
        outlet="configuration"
        overwrite="true"
        outputToSingleFile="true">
        <modelElements>
            <modelElement variable="applicationUseCases">
                <type name="org.andromda.metafacades.uml.FrontEndUseCase">
                    <property name="entryUseCase"/>
                </type>
            </modelElement>
            <modelElement variable="useCases">
                <type name="org.andromda.metafacades.uml.FrontEndUseCase"/>
            </modelElement>
        </modelElements>         
    </template>
    
    <template
        path="templates/bpm4jsf/configuration/faces-config.xml.vsl"
        outputPattern="$facesConfig"
        outlet="configuration"
        overwrite="true"
        outputToSingleFile="true">
        <modelElements>
            <modelElement variable="controllers">
                <type name="org.andromda.metafacades.uml.FrontEndController">
                    <property name="useCase"/>
                    <property name="operations"/>
                </type>
            </modelElement>
            <modelElement variable="applicationUseCases">
                <type name="org.andromda.metafacades.uml.FrontEndUseCase">
                    <property name="entryUseCase"/>
                </type>
            </modelElement>
        </modelElements>    
    </template>
    
    <template
        path="templates/bpm4jsf/forms/Form.java.vsl"
        outputPattern="$generatedFile"
        outlet="forms"
        overwrite="true">
        <modelElements variable="operation">
            <modelElement>
                <type name="org.andromda.metafacades.uml.FrontEndControllerOperation">
                    <property name="formFields"/>
                </type>
            </modelElement>
        </modelElements>
    </template>
    
    <template
        path="templates/bpm4jsf/forms/FormImpl.java.vsl"
        outputPattern="$generatedFile"
        outlet="forms"
        overwrite="true">
        <modelElements variable="action">
            <modelElement>
                <type name="org.andromda.metafacades.uml.FrontEndAction">
                    <property name="formFields"/>
                </type>
            </modelElement>
        </modelElements>
    </template>
    
    <template
        path="templates/bpm4jsf/controllers/ControllerImpl.java.vsl"
        outputPattern="$generatedFile"
        outlet="controller-impls"
        overwrite="false">
        <modelElements variable="controller">
            <modelElement>
                <type name="org.andromda.metafacades.uml.FrontEndController">
                    <property name="useCase"/>
                    <property name="operations"/>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template
        path="templates/bpm4jsf/controllers/Controller.java.vsl"
        outputPattern="$generatedFile"
        outlet="controllers"
        overwrite="true">
        <modelElements variable="controller">
            <modelElement>
                <type name="org.andromda.metafacades.uml.FrontEndController">
                    <property name="useCase"/>
                    <property name="operations"/>
                </type>
            </modelElement>
        </modelElements>
    </template>
    
    <template
        path="templates/bpm4jsf/messages/messages.properties.vsl"
        outputPattern="${messageResources}.properties"
        outlet="messages"
        overwrite="true"
        outputToSingleFile="true">
        <modelElements variable="applicationUseCases">
            <modelElement variable="applicationUseCases">
                <type name="org.andromda.metafacades.uml.FrontEndUseCase">
                    <property name="entryUseCase"/>
                </type>
            </modelElement>            
        </modelElements>
    </template>
    
    <template
        path="templates/bpm4jsf/views/jsp/includes/includes.jspf.vsl"
        outputPattern="$jspIncludes"
        outlet="jsps"
        overwrite="true"
        generateEmptyFiles="true"/>
    
    <template
        path="templates/bpm4jsf/views/jsp/includes/head.jspf.vsl"
        outputPattern="includes/head.jspf"
        outlet="jsps"
        overwrite="true"/>
    
    <template
        path="templates/bpm4jsf/views/jsp/includes/footer.jspf.vsl"
        outputPattern="includes/footer.jspf"
        outlet="jsps"
        overwrite="true"/>
    
    <template
        path="templates/bpm4jsf/views/jsp/includes/header.jsp.vsl"
        outputPattern="includes/header.jsp"
        outlet="jsps"
        overwrite="true"
        outputToSingleFile="true"/>
    
    <template
        path="templates/bpm4jsf/views/jsp/includes/navigation.jsp.vsl"
        outputPattern="includes/navigation.jsp"
        outlet="jsps"
        overwrite="true"/>
    
    <template
        path="templates/bpm4jsf/views/jsp/layout-options.jsp.vsl"
        outputPattern="layout/layout-options.jsp"
        outlet="jsps"
        overwrite="true"/>
    
    <template
        path="templates/bpm4jsf/views/jsp/includes/menu.jspf.vsl"
        outputPattern="includes/menu.jspf"
        outlet="jsps"
        overwrite="true"
        outputToSingleFile="true">
        <modelElements>
            <modelElement variable="useCases">
                <type name="org.andromda.metafacades.uml.FrontEndUseCase"/>
            </modelElement>
        </modelElements>        
    </template>
    
    <template
        path="templates/bpm4jsf/flow/ActionForward.java.vsl"
        outputPattern="$action.fullyQualifiedActionClassPath"
        outlet="controllers"
        overwrite="true">
        <modelElements>
            <modelElement variable="action">
                <type name="org.andromda.metafacades.uml.FrontEndUseCase"/>
            </modelElement>
            <modelElement>
                <type name="org.andromda.metafacades.uml.FrontEndUseCase">
                    <property name="actionForwards" variable="action"/>
                </type>
            </modelElement>
        </modelElements>
    </template>
    
    <template
        path="templates/bpm4jsf/flow/ViewPopulator.java.vsl"
        outputPattern="${view.populatorPath}.java"
        outlet="controllers"
        overwrite="true">
        <modelElements variable="view">
            <modelElement>
                <type name="org.andromda.metafacades.uml.FrontEndView">
                    <property name="populatorRequired"/>
                </type>
            </modelElement>
        </modelElements>
    </template>
    
    <template
        path="templates/bpm4jsf/views/jsp/view.jsp.vsl"
        outputPattern="${view.path}.jsp"
        outlet="jsps"
        overwrite="true">
        <modelElements variable="view">
            <modelElement>
                <type name="org.andromda.metafacades.uml.FrontEndView"/>
            </modelElement>
        </modelElements>
    </template>
    
    <template
        path="templates/bpm4jsf/views/jsp/includes/view-action.jspf.vsl"
        outputPattern="${action.viewFragmentPath}.jspf"
        outlet="jsps"
        overwrite="true">
        <modelElements variable="action">
            <modelElement>
                <type name="org.andromda.metafacades.uml.FrontEndAction">
                    <property name="tableLink">false</property>
                </type>
            </modelElement>
        </modelElements>
    </template>
    
    <template
        path="templates/bpm4jsf/views/jsp/action-forward.jsp.vsl"
        outputPattern="${action.path}.jsp"
        outlet="jsps"
        overwrite="true">
        <modelElements>
            <modelElement variable="action">
                <type name="org.andromda.metafacades.uml.FrontEndUseCase"/>
            </modelElement>
            <modelElement>
                <type name="org.andromda.metafacades.uml.FrontEndUseCase">
                    <property name="actionForwards" variable="action"/>
                </type>
            </modelElement>
        </modelElements>
    </template>
    
    <template
        path="templates/bpm4jsf/views/jsp/includes/view-table.jspf.vsl"
        outputPattern="${table.view.path}-${table.name}.jspf"
        outlet="jsps"
        overwrite="true">
        <modelElements variable="table">
            <modelElement>
                <type name="org.andromda.metafacades.uml.FrontEndParameter">
                    <property name="table"/>
                </type>
            </modelElement>
        </modelElements>
    </template>
    
    <template
        path="templates/bpm4jsf/views/jsp/includes/view-hidden-parameters.jspf.vsl"
        outputPattern="${action.viewFragmentPath}-hidden-params.jspf"
        outlet="jsps"
        overwrite="true">
        <modelElements variable="action">
            <modelElement>
                <type name="org.andromda.metafacades.uml.FrontEndAction">
                    <property name="tableLink">false</property>
                    <property name="hiddenParameters"/>
                </type>
            </modelElement>
        </modelElements>
    </template>
    
    <template
        path="templates/bpm4jsf/views/jsp/index.jsp.vsl"
        outputPattern="$welcomeFileName"
        outlet="jsps"
        overwrite="true"
        outputToSingleFile="true">
        <modelElements>
            <modelElement variable="applicationUseCases">
                <type name="org.andromda.metafacades.uml.FrontEndUseCase">
                    <property name="entryUseCase"/>
                </type>
            </modelElement>
        </modelElements>
    </template>
    
    <template
        path="templates/bpm4jsf/views/rendering/LayoutOptions.java.vsl"
        outputPattern="$generatedFile"
        outlet="managed-beans"
        overwrite="true"/>
    
    <template
        path="templates/bpm4jsf/utils/Messages.java.vsl"
        outputPattern="$stringUtils.replace($managedBeansPackage, '.', '/')/${className}.java"
        outlet="managed-beans"
        overwrite="true"/>
    
    <template
        path="templates/bpm4jsf/utils/CollectionSorter.java.vsl"
        outputPattern="$stringUtils.replace($managedBeansPackage, '.', '/')/${className}.java"
        outlet="managed-beans"
        overwrite="true"/>
    
    <template
        path="templates/bpm4jsf/exception/PatternMatchingExceptionHandler.java.vsl"
        outputPattern="$stringUtils.replace($managedBeansPackage, '.', '/')/${patternMatchingExceptionHandler}.java"
        outlet="managed-beans"
        overwrite="true"/>

    <!-- cartridge-template merge-point -->

</cartridge>