<cartridge>

    <!-- define the template objects that are made availble to the template -->
    <templateObject name="stringUtils" className="org.apache.commons.lang.StringUtils"/>
    <templateObject name="collectionUtils" className="org.apache.commons.collections.CollectionUtils"/>
    <templateObject name="transform" className="org.andromda.cartridges.ejb3.EJB3ScriptHelper"/>
    <!-- cartridge-templateObject merge-point-->

    <!-- cartridge-property merge-point-->

    <!-- cartridge-resource merge-point -->

    <property reference="entityManagerName"/>
    <property reference="entityManagerJTADataSource"/>
    <property reference="hibernateHbm2DDLAuto"/>
    <property reference="hibernateDialect"/>
    <property reference="hibernateShowSql"/>
    <property reference="hibernateCacheProvider"/>
    <property reference="hibernateTreecacheMbeanObject"/>
    <property reference="serviceLocatorName"/>
    <property reference="ejb3TypesPackage"/>

    <!-- Entity Bean Templates -->

    <template 
	    path="templates/ejb3/EntityEmbeddable.vsl"
        outputPattern="$generatedFile" 
        outlet="entity-beans" 
        overwrite="true">
        <modelElements variable="entity">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <!-- 
        Do not generate the entity implementation class if marked
        to be an embeddable super class OR is a subclass of an 
        entity inheritance hierarchy.
    -->
    <template 
	    path="templates/ejb3/Entity.vsl"
        outputPattern="$generatedFile" 
        outlet="entity-impls"
        overwrite="false">
        <modelElements variable="entity">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade">
                    <property name="embeddableSuperclass">false</property>
                    <property name="requiresGeneralizationMapping">false</property>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template 
        path="templates/ejb3/EntityListener.vsl"
        outputPattern="$generatedFile" 
        outlet="entity-impls"
        overwrite="false">
        <modelElements variable="entity">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template 
        path="templates/ejb3/EntityCompositePK.vsl"
        outputPattern="$generatedFile" 
        outlet="entity-beans"
        overwrite="true">
        <modelElements variable="entity">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade">
                    <property name="compositePrimaryKeyPresent">true</property>
                </type>
            </modelElement>
        </modelElements>
    </template>
    
    <template
        path="templates/ejb3/persistence.xml.vsl"
        outputPattern="META-INF/persistence.xml"
        outlet="entity-config"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements variable="entities">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EntityFacade"/>
            </modelElement>
        </modelElements>
    </template>
    
    <!-- Session Bean Templates -->

    <template 
        path="templates/ejb3/SessionBean.vsl"
        outputPattern="$generatedFile" 
        outlet="session-beans"
        overwrite="true">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template 
        path="templates/ejb3/SessionLocal.vsl"
        outputPattern="$generatedFile" 
        outlet="session-beans"
        overwrite="true" 
        generateEmptyFiles="true">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade">
                    <property name="viewTypeLocal">true</property>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template 
        path="templates/ejb3/SessionRemote.vsl"
        outputPattern="$generatedFile" 
        outlet="session-beans" 
        overwrite="true"
        generateEmptyFiles="true">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade">
                    <property name="viewTypeRemote">true</property>
                </type>
            </modelElement>
        </modelElements>
    </template>

    <template 
        path="templates/ejb3/SessionBeanImpl.vsl"
        outputPattern="$generatedFile" 
        outlet="session-impls"
        overwrite="false">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>

    <template 
        path="templates/ejb3/SessionListener.vsl"
        outputPattern="$generatedFile" 
        outlet="session-impls"
        overwrite="false">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>
	
    <template
        path="templates/ejb3/ServiceDelegate.vsl"
        outputPattern="$generatedFile"
        outlet="services"
        overwrite="true">
        <modelElements variable="service">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>
    
    <template
        path="templates/ejb3/ServiceLocator.vsl"
        outputPattern="$generatedFile"
        outlet="services"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
        </modelElements>
    </template>
    
    <template
        path="templates/ejb3/ejb-jar.xml.vsl"
        outputPattern="META-INF/ejb-jar.xml"
        outlet="session-config"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
            <modelElement variable="mdbs">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade"/>
            </modelElement>
        </modelElements>
    </template>
    
    <template
        path="templates/ejb3/jboss.xml.vsl"
        outputPattern="META-INF/jboss.xml"
        outlet="session-config"
        overwrite="true"
        outputToSingleFile="true"
        outputOnEmptyElements="false">
        <modelElements>
            <modelElement variable="services">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3SessionFacade"/>
            </modelElement>
            <modelElement variable="mdbs">
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade"/>
            </modelElement>
        </modelElements>
    </template>
    
	<!-- Message Driven Bean Templates -->
	
    <template 
        path="templates/ejb3/MessageDrivenBean.vsl"
        outputPattern="$generatedFile" 
        outlet="message-driven-beans"
        overwrite="true">
        <modelElements variable="mdb">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade"/>
            </modelElement>
        </modelElements>
    </template>
    
    <template 
        path="templates/ejb3/MessageDrivenBeanImpl.vsl"
        outputPattern="$generatedFile" 
        outlet="message-driven-impls"
        overwrite="false">
        <modelElements variable="mdb">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade"/>
            </modelElement>
        </modelElements>
    </template>
    
    <template 
        path="templates/ejb3/MessageDrivenListener.vsl"
        outputPattern="$generatedFile" 
        outlet="message-driven-impls"
        overwrite="false">
        <modelElements variable="mdb">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3MessageDrivenFacade"/>
            </modelElement>
        </modelElements>
    </template>
	
	<!-- Common Templates -->
	
    <template 
        path="templates/ejb3/Interceptor.vsl"
        outputPattern="$generatedFile" 
        outlet="interceptors"
        overwrite="false">
        <modelElements variable="interceptor">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3InterceptorFacade"/>
            </modelElement>
        </modelElements>
    </template>
	
    <template
        path="templates/ejb3/Enumeration.vsl"
        outputPattern="$generatedFile"
        outlet="enumerations"
        overwrite="true">
        <modelElements variable="enum">
            <modelElement>
                <type name="org.andromda.cartridges.ejb3.metafacades.EJB3EnumerationFacade"/>
            </modelElement>
        </modelElements>
    </template>
    
    <!-- cartridge-template merge-point -->

</cartridge>